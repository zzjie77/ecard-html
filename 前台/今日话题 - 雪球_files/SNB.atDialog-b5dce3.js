define("SNB.atDialog.js",["at-dialog.jade.js","SNB.editor"],function(t){var e,a,s=t("./at-dialog.jade"),i=t("SNB.editor.js"),o=$.Deferred(),r=o.promise(),d=function(t){function s(){if(!l.hasClass("disabled")){var a=SNB.Util.cleanContent(d.getContent(),!1,d.editor);if(!a)return d.$textarea.addClass("error"),n.text("请输入内容。"),!1;if(SNB.Util.isContentSame(a,e)&&!t.data("isShare"))return d.$textarea.addClass("error"),n.text("请输入内容再发布"),!1;l.addClass("disabled"),SNB.Util.updateStatus({status:a},function(){l.removeClass("disabled"),t.dialog("close")},function(){l.removeClass("disabled")})}}var r=$(".tipsdivcontent",t),d=r.data("ta"),n=$(".errMsg",t),l=$(".submitAtHeButton",t);if(t.dialog({title:"有什么话对"+a+"说：",modal:!0,width:520}),!d){d=i.init(r,{$emotion:$(".showFaceButton",t),$stock:$(".addStock",t),ctrlReturn:!0,submitFunc:s});var c=function(){n.text(""),d.$textarea.removeClass("error")};d.$textarea.focus(c),$(".cancelAtHeButton",t).click(function(){t.dialog("close")}),$.browser.isMobile?o.resolve(d):d.editor||d.upgrade({autoheight:!1},function(){$(".ueditor-wrapper",t).height(100),d.editor.addListener("keyup",c),o.resolve(d)}),l.click(s)}n.text(""),l.removeClass("disabled")};$(function(){$("body").on("click",'[data-toggle="at"]',function(t){t.preventDefault();var i=this;a=$(this).data("target")||$(this).attr("data-target"),e=$(this).attr("data-defaulttext")||"对@"+a+" 说：","tablet"!==SNB.data.app_type?SNB.Util.checkLogin(function(){$("body").findOrAppend(">.ui-dialog>#dialog-at-he",s,function(t){d(t),$(i).data("isShare")&&t.dialog({title:"分享到雪球"}).data("isShare",$(i).data("isShare")),r.done(function(t){t.reset(e,!0)})})},t):SNB.Util.callBrick({atUser:{name:a,atUserContent:e}})})})}),define("at-dialog.jade.js",function(require,exports,module){function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){buf.push('<div id="dialog-at-he" class="dialog-wrapper"><div class="tipsdivcontent"><textarea id="atHeStatusTextBox" class="tips_textarea"></textarea></div><p class="counttxt"><span title="表情" class="showFaceButton"></span><span title="股票" class="addStock"></span><span class="wordsRemain"></span></p><div style="text-align:center;width:100%"><span style="color: red" class="errMsg"></span><input type="button" value="发布" class="submit submitAtHeButton disabled"/></div></div>')}return buf.join("")}module.exports=anonymous});